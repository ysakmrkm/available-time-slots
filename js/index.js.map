{"version":3,"file":"index.js","sourceRoot":"../../src/cs/","sources":["index.coffee"],"names":[],"mappings":"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","sourcesContent":["class AvailableTimeSlots\n  constructor: (target, options)->\n    @prevHtml = '<div id=\"ats-prev-week\" class=\"ats-nav__item\"><</div>'\n    @nextHtml = '<div id=\"ats-next-week\" class=\"ats-nav__item\">></div>'\n    @defaults = {\n      availabileTimeSlots: [[], [], [], [], [], [], []],\n      isMultiple: false\n      prevHtml: @prevHtml\n      nextHtml: @nextHtml\n      selectedDates: []\n      startDate: new Date()\n      slotSpan: 30\n      businessHour: [0,  23]\n      months: ['1月', '2月', '3月', '4月', '5月', '6月', '7月', '8月', '9月', '10月', '11月', '12月']\n      weekdays: ['日', '月', '火', '水', '木', '金', '土']\n    }\n    @settings = Object.assign({}, @defaults, options)\n    @startNum = (@settings.businessHour[0] * 60) / @settings.slotSpan\n    @endNum = (@settings.businessHour[1] * 60) / @settings.slotSpan\n    @onClick = @settings.onClick\n    @onClickNavigator = @settings.onClickNavigator\n    @target = target\n\n  setDate: (days)->\n    date = new Date(@settings.startDate.valueOf())\n    date.setDate(date.getDate() + days)\n    return date\n\n  getYearName: (year)->\n    return year + '年'\n\n  getMonthName: (index)->\n    return @settings.months[index]\n\n  formatDate: (data)->\n    date = '' + data.getDate()\n    month = '' + (data.getMonth() + 1)\n    year = data.getFullYear()\n\n    if date.length < 2\n      date = '0' + date\n\n    if month.length < 2\n      month = '0' + month\n\n    return year + '-' + month + '-' + date\n\n  getNavigation: ()->\n    previousWeekHtml = '<div id=\"ats-prev-week-container\" class=\"ats-nav\">' + @settings.prevHtml + '</div>'\n    nextWeekHtml = '<div id=\"ats-prev-week-container\" class=\"ats-nav\">' + @settings.nextHtml + '</div>'\n    dateHtml = '<div id=\"ats-current-date-container\">' + @getYearName(@settings.startDate.getFullYear()) + ' ' + @getMonthName(@settings.startDate.getMonth()) + '</div>'\n    navHtml = previousWeekHtml + ' ' + dateHtml + ' ' + nextWeekHtml\n\n    return navHtml\n\n  getCurrentDate: ()->\n    now = new Date()\n    nowDateTime = now.toISOString()\n    nowDate = nowDateTime.split('T')[0]\n\n    return nowDate\n\n  getCurrentTime: (index)->\n    time = new Date(@getCurrentDate() + 'T00:00:00')\n    time.setMinutes(index * @settings.slotSpan)\n\n    return time\n\n  getTimeSlot: ()->\n    tmp = ''\n\n    for i in [@startNum...@endNum]\n      tmp += '<div id=\"ats-time-slot-' + i + '\" class=\"ats-time-slot\">\n      <div class=\"ats-time-slot-number\">' + ('0' + @getCurrentTime(i).getHours()).slice(-2) + ':' + ('0' + @getCurrentTime(i).getMinutes()).slice(-2) + '</div>\n      </div>'\n\n    ret = tmp\n\n    return ret\n\n  getDatesHeader: ()->\n    tmp = ''\n\n    for i in [0...7]\n      d = @setDate(i)\n\n      tmp += '<div id=\"ats-date-heading-' + i + '\" class=\"ats-date-heading\">\n        <div class=\"ats-date-number\">' + d.getDate() + '</div>\n        <div class=\"ats-date-text\">' + @settings.weekdays[d.getDay()] + '</div>\n      </div>'\n\n    ret = tmp\n\n    return ret\n\n  getAvailableTimeSlots: ()->\n    tmp = ''\n\n    for i in [0...7]\n      tmpTimes = ''\n      mark = ''\n\n      for j in [@startNum...@endNum]\n        isAvalable = false\n\n        for k in [0...@settings.availabileTimeSlots[i].length]\n          availableDate = new Date(@getCurrentDate() + 'T' + @settings.availabileTimeSlots[i][k])\n\n          if availableDate.getTime() is @getCurrentTime(j).getTime()\n            isAvalable = true\n\n        if not isAvalable\n          mark = '×'\n          className = 'ats-time-slot'\n        else\n          mark = '○'\n          className = 'ats-time-slot ats-time-slot__available'\n\n        tmpTimes += '<div class=\"' + className + '\" data-time=\"' + ('0' + @getCurrentTime(j).getHours()).slice(-2) + ':' + ('0' + @getCurrentTime(j).getMinutes()).slice(-2) + '\" data-date=\"' + @formatDate(@setDate(i)) + '\">' + mark + '</div>'\n\n      tmp += '<div class=\"ats-time-slot-container\" id=\"ats-time-slot-container-' + i + '\">' + tmpTimes + '</div>'\n\n    return tmp\n\n  setAvailableTimeSlots: (arr)->\n    @settings.availabileTimeSlots = arr\n\n    @render()\n\n  clearAvailableTimeSlots: ()->\n    @settings.availabileTimeSlots = [[], [], [], [], [], [], []]\n\n  clickPrevWeek: ()->\n    document.getElementById('ats-prev-week').addEventListener('click', (e)=>\n      @settings.startDate = @setDate(-7)\n      @clearAvailableTimeSlots()\n      @render(@target)\n\n      if typeof @onClickNavigator is 'function'\n        @onClickNavigator()\n    )\n\n  clickNextWeek: ()->\n    document.getElementById('ats-next-week').addEventListener('click', (e)=>\n      @settings.startDate = @setDate(7)\n      @clearAvailableTimeSlots()\n      @render(@target)\n\n      if typeof @onClickNavigator is 'function'\n        @onClickNavigator()\n    )\n\n  clickAvailableTimeSlot: ()->\n    Array.from(document.getElementsByClassName('ats-time-slot__available')).forEach((target)=>\n      target.addEventListener('click', (e)=>\n        date = target.getAttribute('data-date')\n        time = target.getAttribute('data-time')\n        tmp = date + ' ' + time\n        if target.classList.contains('selected')\n          target.classList.remove('selected')\n          idx = @settings.selectedDates.indexOf(tmp)\n          if idx isnt -1\n            @settings.selectedDates.splice(idx, 1)\n        else\n          if @settings.isMultiple\n            target.classList.add('selected')\n            @settings.selectedDates.push(tmp)\n          else\n            @settings.selectedDates.pop()\n            if not @settings.selectedDates.length\n              Array.from(document.getElementsByClassName('ats-time-slot__available')).forEach((target)->\n                target.classList.remove('selected')\n              )\n\n              target.classList.add('selected')\n              @settings.selectedDates.push(tmp)\n\n        if typeof @onClick is 'function'\n          @onClick()\n      )\n    )\n\n  render: ()->\n    ret = '<div id=\"ats-container\">\n      <div id=\"ats-nav-container\">' + @getNavigation() + '</div>\n      <div id=\"ats-week-container\">\n        <div id=\"ats-times-container\">' + @getTimeSlot() + '</div>\n        <div id=\"ats-dates-container\">' + @getDatesHeader() + '</div>\n        <div id=\"ats-available-time-container\">' + @getAvailableTimeSlots() + '</div>\n      </div>\n    </div>'\n\n    @target.innerHTML = ret\n\n    @clickPrevWeek()\n    @clickNextWeek()\n    @clickAvailableTimeSlot()\n"]}