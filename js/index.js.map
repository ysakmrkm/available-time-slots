{"version":3,"file":"index.js","sourceRoot":"../../src/cs/","sources":["index.coffee"],"names":[],"mappings":"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","sourcesContent":["class AvailableTimeSlots\n  constructor: (target, options)->\n    @prevHtml = '<div id=\"ats-prev-week\" class=\"ats-nav__item ats-nav__item__prev\"><</div>'\n    @nextHtml = '<div id=\"ats-next-week\" class=\"ats-nav__item ats-nav__item__next\">></div>'\n    @defaults = {\n      availabileTimeSlotResource: '',\n      availabileTimeSlots: [[], [], [], [], [], [], []],\n      isMultiple: false\n      prevHtml: @prevHtml\n      nextHtml: @nextHtml\n      selectedDates: []\n      startDate: new Date()\n      slotSpan: 30\n      businessHour: [0,  23]\n      months: ['1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12']\n      weekdays: ['日', '月', '火', '水', '木', '金', '土']\n      holidays: 'https://holidays-jp.github.io/api/v1/date.json'\n    }\n    @settings = Object.assign({}, @defaults, options)\n    @startNum = (@settings.businessHour[0] * 60) / @settings.slotSpan\n    @endNum = (@settings.businessHour[1] * 60) / @settings.slotSpan\n    @onClickTimeSlot = @settings.onClickTimeSlot\n    @onClickNavigator = @settings.onClickNavigator\n    @target = target\n\n  setDate: (days)->\n    date = new Date(@settings.startDate.valueOf())\n    date.setDate(date.getDate() + days)\n    return date\n\n  getYearName: (year)->\n    return year + '年'\n\n  getMonthName: (index)->\n    return @settings.months[index] + '月'\n\n  getWeekdayName: (index)->\n    return '（' + @settings.weekdays[index] + '）'\n\n  formatDate: (data)->\n    date = '' + data.getDate()\n    month = '' + (data.getMonth() + 1)\n    year = data.getFullYear()\n\n    if date.length < 2\n      date = '0' + date\n\n    if month.length < 2\n      month = '0' + month\n\n    return year + '-' + month + '-' + date\n\n  getNavigation: ()->\n    previousWeekHtml = '<div id=\"ats-prev-week-container\" class=\"ats-nav\">' + @settings.prevHtml + '</div>'\n    nextWeekHtml = '<div id=\"ats-prev-week-container\" class=\"ats-nav\">' + @settings.nextHtml + '</div>'\n    dateHtml = '<div id=\"ats-current-date-container\">' + @getYearName(@settings.startDate.getFullYear()) + ' ' + @getMonthName(@settings.startDate.getMonth()) + '</div>'\n    navHtml = previousWeekHtml + ' ' + dateHtml + ' ' + nextWeekHtml\n\n    return navHtml\n\n  getCurrentDate: ()->\n    now = new Date()\n    nowDateTime = now.toISOString()\n    nowDate = nowDateTime.split('T')[0]\n\n    return nowDate\n\n  getCurrentTime: (index)->\n    time = new Date(@getCurrentDate() + 'T00:00:00')\n    time.setMinutes(index * @settings.slotSpan)\n\n    return time\n\n  getTimeLine: ()->\n    tmp = ''\n\n    for i in [@startNum...@endNum]\n      tmp += '<div id=\"ats-time-line-' + i + '\" class=\"ats-time-line\">\n      <div class=\"ats-time-line-number\">' + ('0' + @getCurrentTime(i).getHours()).slice(-2) + ':' + ('0' + @getCurrentTime(i).getMinutes()).slice(-2) + '</div>\n      </div>'\n\n    ret = tmp\n\n    return ret\n\n  getDatesHeader: ()->\n    tmp = ''\n\n    for i in [0...7]\n      date = @setDate(i)\n\n      className = 'ats-date-heading'\n\n      if date.getDay() is 0\n        className += ' ats__sunday'\n      else if date.getDay() is 6\n        className += ' ats__saturday'\n      else\n        className += ' ats__weekday'\n\n      tmp += '<div id=\"ats-date-heading-' + i + '\" class=\"' + className + '\" data-date=\"' + @formatDate(date) + '\">\n        <div class=\"ats-date-number\">' + date.getDate() + '</div>\n        <div class=\"ats-date-text\">' + @getWeekdayName(date.getDay()) + '</div>\n      </div>'\n\n    ret = tmp\n\n    return ret\n\n  getAvailableTimeSlots: ()->\n    tmp = ''\n    now = new Date()\n\n    for i in [0...7]\n      tmpTimes = ''\n      mark = ''\n      date = @setDate(i)\n\n      for j in [@startNum...@endNum]\n        isAvalable = false\n        isPast = false\n\n        className = 'ats-time-slot'\n\n        for k in [0...@settings.availabileTimeSlots[i].length]\n          availableDate = new Date(date.toISOString().split('T')[0] + 'T' + @settings.availabileTimeSlots[i][k])\n          slotDate = new Date(date.toISOString().split('T')[0] + 'T' + ('0' + @getCurrentTime(j).getHours()).slice(-2) + ':' + ('0' + @getCurrentTime(j).getMinutes()).slice(-2))\n\n          if availableDate.getTime() is slotDate.getTime()\n            isAvalable = true\n\n          if slotDate.getTime() - now.getTime() < 0\n            isAvalable = false\n            isPast = true\n\n        if isPast\n          className += ' ats-time-slot__past'\n          isPast = false\n\n        if not isAvalable\n          mark = '×'\n        else\n          mark = '○'\n          className += ' ats-time-slot__available'\n\n        tmpTimes += '<div class=\"' + className + '\" data-time=\"' + ('0' + @getCurrentTime(j).getHours()).slice(-2) + ':' + ('0' + @getCurrentTime(j).getMinutes()).slice(-2) + '\" data-date=\"' + @formatDate(date) + '\">' + mark + '</div>'\n\n      className = 'ats-time-slot-container'\n\n      if date.getDay() is 0\n        className += ' ats__sunday'\n      else if date.getDay() is 6\n        className += ' ats__saturday'\n      else\n        className += ' ats__weekday'\n\n      tmp += '<div id=\"ats-time-slot-container-' + i + '\" class=\"' + className + '\">' + tmpTimes + '</div>'\n\n    return tmp\n\n  setAvailableTimeSlots: (data)->\n    if typeof data is 'string'\n      request = new XMLHttpRequest()\n      request.open('GET', data, true)\n\n      request.onload = ()=>\n        if request.status >= 200 and request.status < 400\n          data = JSON.parse(request.responseText)\n\n          data.data = data.data.sort(()-> Math.random() - 0.5)\n\n          @settings.availabileTimeSlots = data.data\n\n          @render()\n        else\n\n      request.onerror = ()->\n\n      request.send()\n\n    if typeof data is 'object'\n      @settings.availabileTimeSlots = data\n\n      @render()\n\n  clearAvailableTimeSlots: ()->\n    @settings.availabileTimeSlots = [[], [], [], [], [], [], []]\n\n  clickPrevWeek: ()->\n    currentDateTime = new Date(@getCurrentDate()).getTime()\n    startDateTime = new Date(document.getElementById('ats-date-heading-0').getAttribute('data-date')).getTime()\n\n    if startDateTime - currentDateTime < 0\n      document.getElementById('ats-prev-week').classList.add('is-disable')\n\n    document.getElementById('ats-prev-week').addEventListener('click', (e)=>\n      @settings.startDate = @setDate(-7)\n      @clearAvailableTimeSlots()\n      @setAvailableTimeSlots(@settings.availabileTimeSlotResource)\n\n      if typeof @onClickNavigator is 'function'\n        @onClickNavigator()\n    )\n\n  clickNextWeek: ()->\n    document.getElementById('ats-next-week').addEventListener('click', (e)=>\n      @settings.startDate = @setDate(7)\n      @clearAvailableTimeSlots()\n      @setAvailableTimeSlots(@settings.availabileTimeSlotResource)\n\n      document.getElementById('ats-prev-week').classList.remove('is-disable')\n\n      if typeof @onClickNavigator is 'function'\n        @onClickNavigator()\n    )\n\n  clickAvailableTimeSlot: ()->\n    Array.from(document.getElementsByClassName('ats-time-slot__available')).forEach((target)=>\n      target.addEventListener('click', (e)=>\n        date = target.getAttribute('data-date')\n        time = target.getAttribute('data-time')\n        tmp = date + ' ' + time\n        if target.classList.contains('selected')\n          target.classList.remove('selected')\n          idx = @settings.selectedDates.indexOf(tmp)\n          if idx isnt -1\n            @settings.selectedDates.splice(idx, 1)\n        else\n          if @settings.isMultiple\n            target.classList.add('selected')\n            @settings.selectedDates.push(tmp)\n          else\n            @settings.selectedDates.pop()\n            if not @settings.selectedDates.length\n              Array.from(document.getElementsByClassName('ats-time-slot__available')).forEach((target)->\n                target.classList.remove('selected')\n              )\n\n              target.classList.add('selected')\n              @settings.selectedDates.push(tmp)\n\n        if typeof @onClickTimeSlot is 'function'\n          @onClickTimeSlot(@settings.selectedDates)\n      )\n    )\n\n  render: ()->\n    ret = '<div id=\"ats-container\">\n      <div id=\"ats-nav-container\">' + @getNavigation() + '</div>\n      <div id=\"ats-week-container\">\n        <div id=\"ats-times-container\">' + @getTimeLine() + '</div>\n        <div id=\"ats-dates-container\">' + @getDatesHeader() + '</div>\n        <div id=\"ats-available-time-container\">' + @getAvailableTimeSlots() + '</div>\n      </div>\n    </div>'\n\n    @target.innerHTML = ret\n\n    if @settings.holidays isnt ''\n      @updateHoliday()\n\n    @clickPrevWeek()\n    @clickNextWeek()\n    @clickAvailableTimeSlot()\n\n  updateHoliday: ()->\n    request = new XMLHttpRequest()\n    request.open('GET', @settings.holidays, true)\n\n    request.onload = ()->\n      if request.status >= 200 and request.status < 400\n        data = JSON.parse(request.responseText)\n\n        Object.keys(data).forEach((key)->\n          headings = document.getElementsByClassName('ats-date-heading')\n          slots = document.getElementsByClassName('ats-time-slot-container')\n\n          Array.from(headings).forEach((target, index)->\n            current = target.getAttribute('data-date')\n\n            if key is current\n              headings[index].classList.add('ats__holiday')\n              slots[index].classList.add('ats__holiday')\n          )\n        )\n      else\n\n    request.onerror = ()->\n\n    request.send()\n\n  init: ()->\n    @setAvailableTimeSlots(@settings.availabileTimeSlotResource)"]}